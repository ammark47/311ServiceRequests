(function(t){function e(e){for(var o,a,r=e[0],l=e[1],c=e[2],d=0,p=[];d<r.length;d++)a=r[d],s[a]&&p.push(s[a][0]),s[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(o=!1)}o&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},s={app:0},i=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("04f5"),s=n.n(o);s.a},"04f5":function(t,e,n){},"0d91":function(t,e,n){"use strict";var o=n("5e25"),s=n.n(o);s.a},"49ef":function(t,e,n){"use strict";var o=n("9a9f"),s=n.n(o);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var o=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Slideout",{attrs:{touch:!1,toggleSelectors:[".toggle-button",".button.is-primary"]},on:{"on-open":t.logger}},[n("GoogleMapSearch")],1)],1)},i=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"GoogleMapSearch"},[n("nav",{attrs:{id:"menu"}},[n("div",{staticClass:"logo"}),n("div",{staticClass:"searchBar"},[n("b-field",{attrs:{label:"Please enter an address:"}}),n("label",[n("gmap-autocomplete",{on:{place_changed:t.setPlace}})],1)],1),n("button",{staticClass:"button is-primary",attrs:{slot:"trigger"},on:{click:t.getLatLngCoors},slot:"trigger"},[t._v("SEARCH")]),n("section",[n("CustomFilter",{attrs:{filterGroup:t.filterGroup},on:{updateGroup:t.filterServiceRequests}})],1)]),n("main",{attrs:{id:"panel"}},[t._m(0),n("transition",{attrs:{name:"fade"}},[t.showSrBox?n("serviceRequest",{attrs:{infoContent:t.infoContent},on:{"enlarge-text":t.sayHi}}):t._e()],1),n("gmap-map",{staticStyle:{width:"100%",height:"100vh"},attrs:{center:t.center,zoom:17,"map-type-id":"roadmap",options:t.mapOptions}},[n("gmap-info-window",{attrs:{options:t.infoOptions,position:t.infoPosition,opened:t.infoOpened},on:{closeclick:function(e){t.infoOpened=!1}}},[n("div",[n("p",{staticStyle:{color:"black"}},[t._v(t._s(t.infoContent))])])]),t._l(t.markers,function(e,o){return n("gmap-marker",{key:o,attrs:{position:e.position,clickable:!0,uniquekey:e.uniquekey,status:e.status},on:{click:function(n){t.testfunction(e,o)}}})})],2),n("h1",[t._v(t._s(t.msg))])],1)])},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",[n("div",[n("button",{staticClass:"toggle-button"},[t._v("â˜°")])])])}],l=(n("ac6a"),n("6bde")),c=n("c93e"),u=n("bc3a"),d=n.n(u),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"customfilter"},[n("div",[n("b-field",{attrs:{label:"Service requests between"}},[n("b-datepicker",{attrs:{placeholder:"Type or select a date...",icon:"calendar-today",readonly:!0},model:{value:t.filterGroup.date.start,callback:function(e){t.$set(t.filterGroup.date,"start",e)},expression:"filterGroup.date.start"}})],1)],1),n("div",[n("b-field",{attrs:{label:"and:"}},[n("b-datepicker",{attrs:{placeholder:"Type or select a date...",icon:"calendar-today",readonly:!0},model:{value:t.filterGroup.date.end,callback:function(e){t.$set(t.filterGroup.date,"end",e)},expression:"filterGroup.date.end"}})],1)],1)])},f=[],h={name:"customfilter",data:function(){var t=new Date;return t=t.setDate(t.getDate()-1),console.log(t),{filterGroup:{agencyName:[],statusType:[],date:{start:new Date(t),end:new Date}}}},methods:{test:function(){console.log("test")}},watch:{filterGroup:{handler:function(t){this.$emit("updateGroup",t)},deep:!0}},props:[""]},m=h,g=(n("0d91"),n("2877")),v=Object(g["a"])(m,p,f,!1,null,"25fc17cc",null);v.options.__file="CustomFilter.vue";var _=v.exports,y=n("dc22"),C=n.n(y),b=n("2f62"),k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"serviceRequests"},[n("div",{staticClass:"container is-fluid srBox"},[n("div",{staticClass:"closeSrBox"},[n("button",{on:{click:function(e){t.$emit("enlarge-text")}}},[t._v("X")])]),n("h2",[t._v("Service Request #"+t._s(t.infoContent.uniquekey)+" ")]),n("div",{staticClass:"columns is-multiline"},[n("div",{staticClass:"column is-one-fifth"},[n("h3",[t._v("Status")]),n("div",{staticClass:"status"},[t._v(t._s(t.infoContent.status))])]),n("div",{staticClass:"column is-one-fifth"},[n("div",{staticClass:"columns is-multiline is-mobile"},[n("div",{staticClass:"column"},[n("h3",[t._v(" Date Created ")]),n("h4",[t._v(" "+t._s(t.infoContent.created_date))])]),n("div",{staticClass:"column"},[n("h3",[t._v(" Date Closed ")]),n("h4",[t._v(" "+t._s(t.infoContent.closed_date))])])])]),n("div",{staticClass:"column last-col"},[n("div",{staticClass:"columns is-multiline is-mobile"},[n("div",{staticClass:"column"},[n("h3",[t._v(" Agency ")]),n("h4",[t._v(" "+t._s(t.infoContent.agency_name))])]),n("div",{staticClass:"column"},[n("h3",[t._v(" Incident Address ")]),n("h4",[t._v(" "+t._s(t.infoContent.incident_address)+" ")])])])])]),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-one-fourth"},[n("h3",[t._v("Complaint Type")]),n("h4",[t._v(" "+t._s(t.infoContent.complaint_type))])]),n("div",{staticClass:"column is-two-thirds"},[n("h3",[t._v("Complaint Description")]),n("h4",[t._v(" "+t._s(t.infoContent.description)+" ")])])]),n("div",{staticClass:"columns lastItem"},[n("div",{staticClass:"column"},[n("h3",[t._v("Resolution Description")]),n("h4",[t._v(" "+t._s(t.infoContent.resolution))])])])])])},w=[],S={props:["infoContent","showSrBox"],methods:{notify:function(){this.$dispatch("child-msg",this.first_column),this.msg=" "}},data:function(){return{first_column:"1st",second_column:"2nd",third_column:"3rd",fourth_column:"4th"}}},O=S,x=(n("49ef"),Object(g["a"])(O,k,w,!1,null,"7cbd7b46",null));x.options.__file="serviceRequest.vue";var A=x.exports,j={name:"googlemapsearch",components:{CustomFilter:_,serviceRequest:A},data:function(){return{center:{lat:45.508,lng:-73.587},mapOptions:{mapTypeControl:!1,zoomControl:!0},markers:[],places:[],filterGroup:{},currentPlace:null,checkboxGroup:[],infoPosition:null,infoContent:{status:null,latitude:null,longitude:null,uniquekey:null,agency_name:null,incident_address:null,created_date:null,closed_date:null,due_date:null,complaint_type:null,description:null,resolution:null},infoOpened:!1,infoCurrentKey:null,showSrBox:!1,infoOptions:{pixelOffset:{width:0,height:-35}}}},computed:Object(c["a"])({},Object(b["c"])(["getAddress"])),mounted:function(){this.geolocate()},methods:Object(c["a"])({sayHi:function(){this.showSrBox=!1},setPlace:function(t){this.currentPlace=t},convertToDate:function(t){var e=t;return e.substring(5,7)+"/"+e.substring(8,10)+"/"+e.substring(0,4)},testfunction:function(t,e){this.center={lat:this.markers[e].position.lat,lng:this.markers[e].position.lng},this.infoPosition={lat:this.markers[e].position.lat,lng:this.markers[e].position.lng},this.infoContent={status:this.markers[e].position.status,uniquekey:this.markers[e].position.uniquekey,latitude:this.markers[e].position.lat,longitude:this.markers[e].position.lng,agency_name:this.markers[e].position.agency_name,incident_address:this.markers[e].position.incident_address,created_date:this.convertToDate(this.markers[e].position.created_date),closed_date:this.markers[e].position.closed_date,due_date:this.markers[e].position.due_date,complaint_type:this.markers[e].position.complaint_type,description:this.markers[e].position.descriptor,resolution:this.markers[e].position.resolution},"undefined"!==typeof this.infoContent.closed_date&&(console.log("converted"+this.infoContent.closed_date),this.infoContent.closed_date=this.convertToDate(this.infoContent.closed_date)),console.log(Object(l["a"])(this.infoContent.closed_date)),void 0==this.infoContent.description&&(this.infoContent.description="No description available."),void 0==this.infoContent.resolution&&(this.infoContent.description="No description available."),this.infoCurrentKey==e?(this.infoOpened=!this.infoOpened,this.showSrBox=!this.showSrBox):(this.infoOpened=!0,this.showSrBox=!0,this.infoCurrentKey=e)},getPosition:function(t,e){return{lat:parseFloat(t[e].lat),lng:parseFloat(t[e].lng),status:parseFloat(t[e].status)}},getLatLngCoors:function(){if(this.currentPlace){var t={lat:this.currentPlace.geometry.location.lat(),lng:this.currentPlace.geometry.location.lng()};this.center=t,this.markers=[],this.$store.dispatch("updateAddressValue",t),this.getServiceRequest(this.$store.getters.getAddress),this.currentPlace=null}},getServiceRequest:function(t){var e=this,n=new Date,o=new Date,s=0;o.setDate(n.getDate()-s),n=n.toISOString().substring(0,n.toISOString().indexOf(".")),o=o.toISOString().substring(0,o.toISOString().indexOf(".")),console.log(n,o);var i="https://data.cityofnewyork.us/resource/fhrw-4uyv.json?",a=i+"$where=within_circle(location,"+t.lat+","+t.lng+",100)";d.a.get(a).then(function(t){return e.convertRequestsToMarkers(t.data)})},filterServiceRequests:function(t){var e=this,n="https://data.cityofnewyork.us/resource/fhrw-4uyv.json?",o=this.$store.getters.getAddress,s=n+"$where=within_circle(location,"+o.lat+","+o.lng+",500)";this.markers=[];new C.a.Consumer("data.cityofnewyork.us");for(var i in t)switch(i){case"date":var a=t[i]["start"].toISOString();a=a.substring(0,a.indexOf("."));var r=t[i]["end"].toISOString();r=r.substring(0,r.indexOf(".")),s+=encodeURI(" and created_date between")+"%27"+encodeURI(a)+"%27"+encodeURI(" and ")+"%27"+encodeURI(r)+"%27";break}s+="&$limit=100",console.log(s),d.a.get(s).then(function(t){return e.convertRequestsToMarkers(t.data)})},convertRequestsToMarkers:function(t){var e,n=this;t.forEach(function(t){e={uniquekey:parseFloat(t.unique_key),lat:parseFloat(t.latitude),lng:parseFloat(t.longitude),status:t.status,agency_name:t.agency_name,incident_address:t.incident_address,created_date:t.created_date,closed_date:t.closed_date,due_date:t.due_date,complaint_type:t.complaint_type,description:t.descriptor,resolution:t.resolution_description},n.markers.push({position:e})})},geolocate:function(){var t=this;navigator.geolocation.getCurrentPosition(function(e){t.center={lat:e.coords.latitude,lng:e.coords.longitude},t.$store.dispatch("updateAddressValue",t.center),t.getServiceRequest(t.$store.getters.getAddress)})}},Object(b["d"])(["updateAddress"]),Object(b["b"])(["updateAddressValue"])),props:{msg:String},events:{"child-msg":function(t){console.log(t)}}},q=j,P=(n("86dd"),Object(g["a"])(q,a,r,!1,null,"0f6d32aa",null));P.options.__file="GoogleMapSearch.vue";var R=P.exports,$=n("9098"),G=n.n($),D={name:"app",components:{GoogleMapSearch:R,Slideout:G.a},mounted:function(){},methods:{logger:function(){}}},T=D,I=(n("034f"),Object(g["a"])(T,s,i,!1,null,null,null));I.options.__file="App.vue";var M=I.exports,B=n("3fa7"),F=n.n(B),E=n("755e"),L=n("28dd");o["a"].use(b["a"]);var H=new b["a"].Store({state:{address:{lat:0,lng:0}},getters:{getAddress:function(t){return t.address}},mutations:{updateAddress:function(t,e){t.address.lat=e.lat,t.address.lng=e.lng}},actions:{updateAddressValue:function(t,e){t.commit("updateAddress",e)}}});n("8e0a");o["a"].use(F.a),o["a"].use(b["a"]),o["a"].use(L["a"]),o["a"].http.headers.common["Content-Type"]="application/json",o["a"].http.headers.common["Access-Control-Allow-Origin"]="*",o["a"].http.headers.common["Accept"]="application/json, text/plain, */*",o["a"].http.headers.common["Access-Control-Allow-Headers"]="Origin, Accept, Content-Type, Authorization, Access-Control-Allow-Origin",o["a"].use(E,{load:{key:"AIzaSyCvX_Ii3_7Lg11PF3dOi95f1t3HywAdsLw",libraries:"places"}}),o["a"].config.productionTip=!1,new o["a"]({store:H,render:function(t){return t(M)}}).$mount("#app")},"5e25":function(t,e,n){},8:function(t,e){},"86dd":function(t,e,n){"use strict";var o=n("f9a5"),s=n.n(o);s.a},"9a9f":function(t,e,n){},f9a5:function(t,e,n){}});
//# sourceMappingURL=app.005a362e.js.map